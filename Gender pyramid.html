<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Pyramid Chart gender</title>
    <link rel="stylesheet" href="pyramid/pyramid.css">
    <script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="http://d3js.org/queue.v1.min.js"></script>
	<script src="pyramid/pyramid.js"></script>
  </head>
  <body>
    <h2>Pyramid Chart Gender by State</h1>
    <div id="vis"></div>
	 <script>
     // this function is called after the HTML document is fully loaded


            // variables keeping global knowledge of the data
            var allData = [];
			
            // call this function after both files are loaded -- error should be "null" if no error
            var dataLoaded = function (error, _allData) {

                if (!error) {

                    _allData.forEach(function (d) {
					 
                                allData.push ({
                                    sharedLabel: d.Location ,
                                    barData1: d.Female ,
									barData2: d.Male
                                });
     
                          })
						  
						  debugger;
					     build(allData);
                }
            }

            var startHere = function(){
			
			
			    // Load data asynchronously
		        queue()
                  .defer(d3.csv, "data/raw_genderbystate2013.csv")
				  .await(dataLoaded);
				  

                //TODO: load data here and call "dataLoaded" afterwards
                // Hint: http://giscollective.org/d3-queue-js/
				dataLoaded(allData);
				//initVis();


            }

            startHere();
			
			
    </script>
  </body>
</html>

